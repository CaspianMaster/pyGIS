
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Understanding PROJ.4 and EPSG Codes &#8212; Open Source Geospatial Programming &amp; Remote Sensing</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vector Skills" href="e_vector_op_intro.html" />
    <link rel="prev" title="CRS Exercises" href="d_exercises.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/pygis.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Open Source Geospatial Programming & Remote Sensing</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="a_intro.html">
   Welcome to PyGIS
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="b_intro_py.html">
   Welcome - Let’s get started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="b_about_py.html">
   Getting Started in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="b_getting_started.html">
   Setting up Your Python Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="b_python_by_example.html">
   An Introductory Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="b_learn_more.html">
   Learn More
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Data Types
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="c_features.html">
   Feature Representation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="c_store_features.html">
   Data Storage Formats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="c_vectors.html">
   Vector Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="c_rasters.html">
   Raster Data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Nature of Coordinate Systems
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="d_crs_what_is_it.html">
   What is a CRS?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="d_affine.html">
   Affine Transforms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="d_vector_crs_intro.html">
   Vector CRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="d_raster_crs_intro.html">
   Raster CRS
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="d_exercises.html">
   CRS Exercises
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Understanding PROJ.4 and EPSG Codes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Basic Operations
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="e_vector_op_intro.html">
   Vector Skills
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="c_attributes.html">
     Attributes &amp; Indexing
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="e_raster_op_intro.html">
   Raster Skills
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Remote Sensing
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="f_rs_intro.html">
   Remote Sensing w. Geowombat
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="f_rs_basics.html">
     Remote Sensing Basics
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="f_rs_common_task.html">
   Common Tasks
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="f_rs_task1.html">
     Something
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/d_understand_crs_codes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-and-setting-coordinate-reference-systems-in-python">
   Checking and Setting Coordinate Reference Systems in Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checking-a-dataset-s-coordinate-reference-system">
     Checking a dataset’s coordinate reference system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-a-dataset-s-crs">
     Change a dataset’s CRS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proj-4-string">
   PROJ.4 String
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-in-a-proj-4-string">
     What is in a PROJ.4 string?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-a-custom-crs-using-proj-4-string">
     Creating a custom CRS using PROJ.4 string
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#epsg-codes">
   EPSG Codes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#obtaining-epsg-code-from-proj-4-string">
     Obtaining EPSG Code from PROJ.4 String
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="understanding-proj-4-and-epsg-codes">
<h1>Understanding PROJ.4 and EPSG Codes<a class="headerlink" href="#understanding-proj-4-and-epsg-codes" title="Permalink to this headline">¶</a></h1>
<p>Lesson objectives:</p>
<ul class="simple">
<li><p>Understand how to read a PROJ4 string</p></li>
<li><p>Understand how a PROJ4 string relates to an EPSG code</p></li>
<li><p>Visually explore changing PROJ4 string parameters</p></li>
</ul>
<p>Steven Chao, v1</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>A coordinate reference system tells Python where and how to place coordinates on Earth’s surface.</p>
<p><a class="reference external" href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf">https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf</a></p>
<p>As you may recall, a coordinate reference system can either be a geographic coordinate system or a projected coordinate system (also known as a map projection). A geographic coordinate system consists of a datum, which consists of an ellipsoid model and how this ellipsoid is aligned with the geoid. It’s spherical in nature, and units are typically angular (latitude and longitude). A projected coordinate system is created by taking a geographic coordinate system and using math to transformg a 3-D surface onto a flat, 2-D surface. Units are typically linear and are oftentimes measured in meters.</p>
<p><a class="reference external" href="https://mgimond.github.io/Spatial/chp09-0.html">https://mgimond.github.io/Spatial/chp09-0.html</a>
<a class="reference external" href="https://www.esri.com/arcgis-blog/products/arcgis-pro/mapping/coordinate-systems-difference/">https://www.esri.com/arcgis-blog/products/arcgis-pro/mapping/coordinate-systems-difference/</a>
<a class="reference external" href="https://automating-gis-processes.github.io/CSC18/lessons/L2/projections.html">https://automating-gis-processes.github.io/CSC18/lessons/L2/projections.html</a>
<a class="reference external" href="https://autogis-site.readthedocs.io/en/stable/notebooks/L2/projections.html">https://autogis-site.readthedocs.io/en/stable/notebooks/L2/projections.html</a></p>
<p>All map projections introduce error because they are inherently imperfect. The “best” or “perfect” projection to use is highly dependent on what needs to mapped and where. Therefore, as you can expect, there are many projections to choose from.</p>
<p><a class="reference external" href="https://autogis-site.readthedocs.io/en/stable/notebooks/L2/projections.html">https://autogis-site.readthedocs.io/en/stable/notebooks/L2/projections.html</a></p>
<p>In this chapter, we will explore the check, utilize, change, and create CRS’s in Python. To provide examples along the way, we will use a shapefile of the Washington, DC, boundary, downloaded from Open Data DC (<a class="reference external" href="https://opendata.dc.gov/datasets/washington-dc-boundary">https://opendata.dc.gov/datasets/washington-dc-boundary</a>).</p>
<p>Let’s begin by reading in this dataset (make sure you have it downloaded and un-zipped on your computer).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import module</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1"># Set filepath to folder containing shapefile</span>
<span class="n">dc_shapefile_filepath</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/Washington_DC_Boundary&quot;</span>

<span class="c1"># Read data</span>
<span class="n">dc</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">dc_shapefile_filepath</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">CPLE_OpenFailedError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">fiona/_shim.pyx</span> in <span class="ni">fiona._shim.gdal_open_vector</span><span class="nt">()</span>

<span class="nn">fiona/_err.pyx</span> in <span class="ni">fiona._err.exc_wrap_pointer</span><span class="nt">()</span>

<span class="ne">CPLE_OpenFailedError</span>: /Washington_DC_Boundary: No such file or directory

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">DriverError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">e8922c191404</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1"># Read data</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">dc_shapefile_filepath</span><span class="p">)</span>

<span class="nn">~/anaconda3/envs/pygisbook/lib/python3.7/site-packages/geopandas/io/file.py</span> in <span class="ni">_read_file</span><span class="nt">(filename, bbox, mask, rows, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span> 
<span class="g g-Whitespace">    </span><span class="mi">159</span>     <span class="k">with</span> <span class="n">fiona_env</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">160</span>         <span class="k">with</span> <span class="n">reader</span><span class="p">(</span><span class="n">path_or_bytes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">features</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span> 
<span class="g g-Whitespace">    </span><span class="mi">162</span>             <span class="c1"># In a future Fiona release the crs attribute of features will</span>

<span class="nn">~/anaconda3/envs/pygisbook/lib/python3.7/site-packages/fiona/env.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span>     <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span>         <span class="k">if</span> <span class="n">local</span><span class="o">.</span><span class="n">_env</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">400</span>             <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>

<span class="nn">~/anaconda3/envs/pygisbook/lib/python3.7/site-packages/fiona/__init__.py</span> in <span class="ni">open</span><span class="nt">(fp, mode, driver, schema, crs, encoding, layer, vfs, enabled_drivers, crs_wkt, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span>         <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>             <span class="n">c</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">driver</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">257</span>                            <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span> <span class="n">enabled_drivers</span><span class="o">=</span><span class="n">enabled_drivers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span>         <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span>             <span class="k">if</span> <span class="n">schema</span><span class="p">:</span>

<span class="nn">~/anaconda3/envs/pygisbook/lib/python3.7/site-packages/fiona/collection.py</span> in <span class="ni">__init__</span><span class="nt">(self, path, mode, driver, schema, crs, encoding, layer, vsi, archive, enabled_drivers, crs_wkt, ignore_fields, ignore_geometry, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">162</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span>             <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">WritingSession</span><span class="p">()</span>

<span class="nn">fiona/ogrext.pyx</span> in <span class="ni">fiona.ogrext.Session.start</span><span class="nt">()</span>

<span class="nn">fiona/_shim.pyx</span> in <span class="ni">fiona._shim.gdal_open_vector</span><span class="nt">()</span>

<span class="ne">DriverError</span>: /Washington_DC_Boundary: No such file or directory
</pre></div>
</div>
</div>
</div>
<p>Let’s also define a function that will allow us to quickly produce a map of our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import module</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">map_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function superimposes all the data on a map and sets a title for the map.&#39;&#39;&#39;</span>    
    
    <span class="c1"># Create subplots</span>
    <span class="c1">#fig, ax = plt.subplots()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    
    <span class="c1"># Set colors</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#a3ddcb&quot;</span><span class="p">,</span> <span class="s2">&quot;#03506f&quot;</span><span class="p">]</span>
    
    <span class="c1"># Iterate through list of data and colors to superimpose them onto map</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
    
    <span class="c1"># Add title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

    <span class="c1"># Remove empty white space around the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can see how the shapefile we just read in looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create map using DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc</span><span class="p">],</span> <span class="s2">&quot;Washington, DC&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_6_0.png" src="../_images/d_understand_crs_codes_6_0.png" />
</div>
</div>
<p>Looks like Washington, DC, albeit a bit lopsided! Now let’s see how we can work with CRS’s in Python.</p>
</div>
<div class="section" id="checking-and-setting-coordinate-reference-systems-in-python">
<h2>Checking and Setting Coordinate Reference Systems in Python<a class="headerlink" href="#checking-and-setting-coordinate-reference-systems-in-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="checking-a-dataset-s-coordinate-reference-system">
<h3>Checking a dataset’s coordinate reference system<a class="headerlink" href="#checking-a-dataset-s-coordinate-reference-system" title="Permalink to this headline">¶</a></h3>
<p>To check the dataset’s CRS (assuming it has one), use the .crs attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get CRS for DC shapefile</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;init&#39;: &#39;epsg:4326&#39;}
</pre></div>
</div>
</div>
</div>
<p>The output is a dictionary with a value of ‘epsg:4326.’ We’ll cover what this means in more detail later in this chapter, but just know for now that an EPSG code is a way to reference a CRS.</p>
</div>
<div class="section" id="change-a-dataset-s-crs">
<h3>Change a dataset’s CRS<a class="headerlink" href="#change-a-dataset-s-crs" title="Permalink to this headline">¶</a></h3>
<p>To change a dataset’s CRS, we’ll need to reproject the data. Here we will project copies of our data twice, once with a <code class="docutils literal notranslate"><span class="pre">PROJ.4</span></code> string and once with a <code class="docutils literal notranslate"><span class="pre">EPSG</span></code> code. The projection will remain in latitude and longitude but we will change the ellipsoid and datum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1: Create a copy of the DC shapefile</span>
<span class="n">dc_reproject_proj4</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Example 1: Reproject the data</span>
<span class="n">dc_reproject_proj4</span> <span class="o">=</span> <span class="n">dc_reproject_proj4</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs&quot;</span><span class="p">)</span>

<span class="c1"># Example 2: Create a copy of the DC shapefile</span>
<span class="n">dc_reproject_epsg</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Example 2: Reproject the data</span>
<span class="n">dc_reproject_epsg</span> <span class="o">=</span> <span class="n">dc_reproject_epsg</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4269</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As seen in these examples, we can pass various values into the to_crs() function. The first example passed a <code class="docutils literal notranslate"><span class="pre">PROJ.4</span></code> string value, and the second example passed an <code class="docutils literal notranslate"><span class="pre">EPSG</span></code> code. These values both reference the same CRS (in this case, NAD83)–they are simply just different ways to reference it. There are some other formats we can pass as values, but we’ll cover proj4proj4<code class="docutils literal notranslate"><span class="pre">proj4</span></code> string and <code class="docutils literal notranslate"><span class="pre">epsg</span></code> in this chapter.</p>
<p>When we call the .crs attribute, it’s no longer ‘epsg:4326,’ which means that the data has been reprojected!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1: Print new CRS of DC</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 1: &quot;</span><span class="p">,</span> <span class="n">dc_reproject_proj4</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>

<span class="c1"># Example 2: Print new CRS of DC</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 2: &quot;</span><span class="p">,</span> <span class="n">dc_reproject_epsg</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example 1:  +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs
Example 2:  {&#39;init&#39;: &#39;epsg:4269&#39;, &#39;no_defs&#39;: True}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="proj-4-string">
<h2>PROJ.4 String<a class="headerlink" href="#proj-4-string" title="Permalink to this headline">¶</a></h2>
<p>“PROJ.4 strings are a compact way to identify a spatial or coordinate reference system. Using the <code class="docutils literal notranslate"><span class="pre">PROJ.4</span></code> syntax, you specify the complete set of parameters including the ellipse, datum, projection units and projection definition that define a particular CRS.”</p>
<p>(<a class="reference external" href="https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/">https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/</a>)</p>
<div class="section" id="what-is-in-a-proj-4-string">
<h3>What is in a PROJ.4 string?<a class="headerlink" href="#what-is-in-a-proj-4-string" title="Permalink to this headline">¶</a></h3>
<p>“Notice that the crs information is structured using a string of characters and numbers that are combined using + signs. The CRS for your data are in the proj4 format. The string contains all of the individual CRS elements that Python or another GIS might need. Each element is specified with a + sign, similar to how a .csv file is delimited or broken up by a ,. After each + we see the CRS element being defined. For example +proj= and +datum=.”</p>
<p>(<a class="reference external" href="https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/">https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/</a>)</p>
<p>“Below is a list of PROJ parameters which can be applied to most coordinate system definitions. This table does not attempt to describe the parameters particular to particular projection types. These can be found on the pages documenting the individual projections.”</p>
<ul class="simple">
<li><p>+a: Semimajor radius of the ellipsoid axis</p></li>
<li><p>+axis: Axis orientation</p></li>
<li><p>+b: Semiminor radius of the ellipsoid axis</p></li>
<li><p>+ellps: Ellipsoid name (see proj -le)</p></li>
<li><p>+k: Scaling factor (deprecated)</p></li>
<li><p>+k_0: Scaling factor</p></li>
<li><p>+lat_0: Latitude of origin</p></li>
<li><p>+lon_0: Central meridian</p></li>
<li><p>+lon_wrap: Center longitude to use for wrapping (see below)</p></li>
<li><p>+over: Allow longitude output outside -180 to 180 range, disables wrapping (see below)</p></li>
<li><p>+pm: Alternate prime meridian (typically a city name, see below)</p></li>
<li><p>+proj: Projection name (see proj -l)</p></li>
<li><p>+units: meters, US survey feet, etc.</p></li>
<li><p>+vunits: vertical units.</p></li>
<li><p>+x_0: False easting</p></li>
<li><p>+y_0: False northing</p></li>
</ul>
<p><a class="reference external" href="https://proj.org/usage/projections.html">https://proj.org/usage/projections.html</a></p>
<p>Be sure to always verify the parameters that are allowed for each projection. You can’t always “mix and match” the above parameters when creating a custom projection.</p>
</div>
<div class="section" id="creating-a-custom-crs-using-proj-4-string">
<h3>Creating a custom CRS using PROJ.4 string<a class="headerlink" href="#creating-a-custom-crs-using-proj-4-string" title="Permalink to this headline">¶</a></h3>
<p>We can change the parameters to create a custom CRS that suits our specific needs. In this section, we will create a CRS tailored to our DC shapefile.</p>
<p>Below are the original and re-projected map of DC from above–these will serve as a reference point for comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Map original DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - WGS84&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="c1"># map_data([dc_reproject_proj4], &quot;Washington, DC - NAD83&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_17_0.png" src="../_images/d_understand_crs_codes_17_0.png" />
<img alt="../_images/d_understand_crs_codes_17_1.png" src="../_images/d_understand_crs_codes_17_1.png" />
</div>
</div>
<p>The two maps above utilize a geographic coordinate system, as evidenced by the latitude and longitude values on the axes. Another way to check is to look at the geometry of the shapefiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check geometry values of original shapefile</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Check geometry values of reprojected shapefile</span>
<span class="c1"># print(dc_reproject_proj4[&#39;geometry&#39;].head())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    POLYGON ((-77.1197952245159 38.93435090401753,...
Name: geometry, dtype: object
0    POLYGON ((-77.1197952245159 38.93435090401753,...
Name: geometry, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Looks like latitude and longitude coordinates! Now, we will reproject the shapefile using a projected coordinate system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_lcc</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://proj.org/operations/projections/lcc.html#parameters</span>
<span class="n">dc_lcc</span> <span class="o">=</span> <span class="n">dc_lcc</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lon_0=-90 +lat_1=33 +lat_2=45 +ellps=GRS80&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_lcc</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - Lambert Conformal Conic&quot;</span><span class="p">)</span>

<span class="c1"># Check geometry values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dc_lcc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    POLYGON ((1106986.81379205 4694966.591875904, ...
Name: geometry, dtype: object
</pre></div>
</div>
<img alt="../_images/d_understand_crs_codes_21_1.png" src="../_images/d_understand_crs_codes_21_1.png" />
</div>
</div>
<p>Here, we used the Lambert Conformal Conic projection. Notice how the values on the axes changed from latitude and longitude to meters. Also notice how the DC appears to be “tilted” to the left when compared to DC in the previous CRS’s. That’s because the center of this projection is at the 90th meridian west (<code class="docutils literal notranslate"><span class="pre">+lon_0=-90</span></code>; negative is used to denote West) and the Equator (<code class="docutils literal notranslate"><span class="pre">+lat_0=0</span></code>; 0 is the default value when not specified in the PROJ.4 string)</p>
<p>We can change the values for lat_0 and lon_0, which refer to the latitude of origin and the central meridian, respectively. We will change those values to 38.9072 and -77.0369, which is the center of DC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_lcc_center</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://proj.org/operations/projections/lcc.html#parameters</span>
<span class="n">dc_lcc_center</span> <span class="o">=</span> <span class="n">dc_lcc_center</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_0=38.9072 +lon_0=-77.0369 +lat_1=33 +lat_2=45 +ellps=GRS80&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_lcc_center</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - Lambert Conformal Conic - DC as Center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_23_0.png" src="../_images/d_understand_crs_codes_23_0.png" />
</div>
</div>
<p>As seen in the new graph above, the values on both axes have changed. The origin (0, 0) is now in the center of DC.</p>
<p>The PROJ.4 string for this projection has two additional parameters lat_1 and lat_2, which specify the first and second parallel respectively. Recall that a conic projection “intersects” a globe at what is termed the standard parallels.</p>
<p><a class="reference external" href="https://proj.org/operations/projections/lcc.html">https://proj.org/operations/projections/lcc.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_lcc_parallels_1</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://proj.org/operations/projections/lcc.html#parameters</span>
<span class="n">dc_lcc_parallels_1</span> <span class="o">=</span> <span class="n">dc_lcc_parallels_1</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_0=38.9072 +lon_0=-77.0369 +lat_1=38.850 +lat_2=39.950 +ellps=GRS80&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_lcc_parallels_1</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - Lambert Conformal Conic - Standard Parallels in DC&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_25_0.png" src="../_images/d_understand_crs_codes_25_0.png" />
</div>
</div>
<p>Two standard parallels at 38.850 N andd 39.950 N were chosen as they fall within the DC boundaries. Nothing really appears to be different; however, these values are important. Look what happens when we assign different values, ones that don’t really make sense for mapping in DC, and compare the resulting DC map to the previous map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_lcc_parallels_2</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://proj.org/operations/projections/lcc.html#parameters</span>
<span class="n">dc_lcc_parallels_2</span> <span class="o">=</span> <span class="n">dc_lcc_parallels_1</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_0=38.9072 +lon_0=-77.0369 +lat_1=10 +lat_2=60 +ellps=GRS80&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_lcc_parallels_1</span><span class="p">,</span> <span class="n">dc_lcc_parallels_2</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - Lambert Conformal Conic - Comparing Standard Parallels&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_27_0.png" src="../_images/d_understand_crs_codes_27_0.png" />
</div>
</div>
<p>It appears DC has shrunk! Of course, that’s not actually the case in reality, but because map projections are inherently imperfect, choosing arbitrary parameters can make things worse. In this case, because the chosen standard parallels are relatively far from each other and from DC, all the data in between the standard parallels end up being compressed even more. For more information, visit <a class="reference external" href="https://giscourses.cfans.umn.edu/sites/giscourses.cfans.umn.edu/files/understanding_map_projections.pdf">https://giscourses.cfans.umn.edu/sites/giscourses.cfans.umn.edu/files/understanding_map_projections.pdf</a>.</p>
<p>Finally, two other parameters we can change are +x_0 and +y_0, which are false easting and false northing respectively. The values assigned to these parameters simply offset the axes by that associated value; they do not change or affect the projection. False easting (with a value of 500,000) is used in Universal Tranverse Mercator (UTM) projections so that negative coordinates are avoided to the west of the central meridian in each zone. Similarly, false northing (with a value of 10,000,000 m) is also used to avoid negative coordinates when a UTM zone is in the southern hemisphere.</p>
<p><a class="reference external" href="http://www.geo.hunter.cuny.edu/~jochen/gtech201/lectures/lec6concepts/Map%20coordinate%20systems/UTM%20and%20UPS.htm">http://www.geo.hunter.cuny.edu/~jochen/gtech201/lectures/lec6concepts/Map coordinate systems/UTM and UPS.htm</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_lcc_false_e</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://proj.org/operations/projections/lcc.html#parameters</span>
<span class="n">dc_lcc_false_e</span> <span class="o">=</span> <span class="n">dc_lcc_false_e</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_0=38.9072 +lon_0=-77.0369 +lat_1=38.850 +lat_2=39.950 +x_0=500000 +y_0=0 +ellps=GRS80&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_lcc_false_e</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - Lambert Conformal Conic - False Easting&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_29_0.png" src="../_images/d_understand_crs_codes_29_0.png" />
</div>
</div>
<p>Notice that the x-axis shifted to the left by 500,000 units. The y-axis stayed the same because we did not use false northing. Now, the “origin” is (500000, 0).</p>
<p>UTM is conformal. So let’s compare our custom projection to UTM Zone 18N (in which DC falls).</p>
<p><a class="reference external" href="https://desktop.arcgis.com/en/arcmap/10.3/guide-books/map-projections/universal-transverse-mercator.htm">https://desktop.arcgis.com/en/arcmap/10.3/guide-books/map-projections/universal-transverse-mercator.htm</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy of the DC shapefile</span>
<span class="n">dc_utm18n</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Reproject the data</span>
<span class="c1"># https://www.spatialreference.org/ref/epsg/wgs-84-utm-zone-18n/</span>
<span class="n">dc_utm18n</span> <span class="o">=</span> <span class="n">dc_utm18n</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span><span class="p">)</span>

<span class="c1"># Map reprojected DC shapefile</span>
<span class="n">map_data</span><span class="p">([</span><span class="n">dc_utm18n</span><span class="p">],</span> <span class="s2">&quot;Washington, DC - UTM Zone 18N&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d_understand_crs_codes_31_0.png" src="../_images/d_understand_crs_codes_31_0.png" />
</div>
</div>
<p>Looks pretty much the same!</p>
</div>
</div>
<div class="section" id="epsg-codes">
<h2>EPSG Codes<a class="headerlink" href="#epsg-codes" title="Permalink to this headline">¶</a></h2>
<p>Many CRS’s are assigned and can be referenced by an EPSG code, which consists of a four or five digit number. EPSG stands for the European Petroleum Survey Group, a now-defunct organization that compiled this CRS dataset. EPSG codes can be further explored at <a class="reference external" href="http://www.epsg-registry.org/">http://www.epsg-registry.org/</a> or <a class="reference external" href="https://spatialreference.org/ref/epsg/">https://spatialreference.org/ref/epsg/</a></p>
<p><a class="reference external" href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf">https://www.nceas.ucsb.edu/sites/default/files/2020-04/OverviewCoordinateReferenceSystems.pdf</a>
<a class="reference external" href="https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/">https://www.earthdatascience.org/courses/use-data-open-source-python/intro-vector-data-python/spatial-data-vector-shapefiles/epsg-proj4-coordinate-reference-system-formats-python/</a></p>
<div class="section" id="obtaining-epsg-code-from-proj-4-string">
<h3>Obtaining EPSG Code from PROJ.4 String<a class="headerlink" href="#obtaining-epsg-code-from-proj-4-string" title="Permalink to this headline">¶</a></h3>
<p>Not all CRS’s have a corresponding EPSG code, but we can find the EPSG code (if it exists) given a PROJ.4 string. To do so, we can use the to_espg() function in the pyproj module.</p>
<p><a class="reference external" href="https://geopandas.org/docs/user_guide/projections.html">https://geopandas.org/docs/user_guide/projections.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import module</span>
<span class="kn">import</span> <span class="nn">pyproj</span>

<span class="k">def</span> <span class="nf">get_epsg</span><span class="p">(</span><span class="n">proj4_string</span><span class="p">,</span> <span class="n">min_confidence</span> <span class="o">=</span> <span class="mi">70</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Function takes a PROJ.4 string and optional minimum confidence level as an input and outputs the relevant EPSG code, if one exists. Source: https://geopandas.org/docs/user_guide/projections.html&#39;&#39;&#39;</span>
    
    <span class="c1"># Get relevant EPSG at the specified minimum confidence level</span>
    <span class="k">return</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">CRS</span><span class="p">(</span><span class="n">proj4_string</span><span class="p">)</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">(</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span><span class="p">)</span>


<span class="c1"># Call function to obtain relevant EPSG code</span>
<span class="c1"># https://www.spatialreference.org/ref/epsg/26943/</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">get_epsg</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_1=38.43333333333333 +lat_2=37.06666666666667 +lat_0=36.5 +lon_0=-120.5 +x_0=2000000 +y_0=500000 +ellps=GRS80 +datum=NAD83 +units=m +no_defs&quot;</span><span class="p">)</span>

<span class="c1"># Print result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26943
</pre></div>
</div>
</div>
</div>
<p>In the example above, we were able to successfully obtain the EPSG code (in this case, NAD83 / California zone 3) because it is exactly matched to the PROJ.4 string. If we’re missing some information in the PROJ.4 string, however, we might not be able to get an exact EPSG code match.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Call function to obtain relevant EPSG code</span>
<span class="n">result_missing</span> <span class="o">=</span> <span class="n">get_epsg</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_1=38.43333333333333 +lat_0=36.5 +lon_0=-120.5 +ellps=GRS80 +datum=NAD83 +units=m +no_defs&quot;</span><span class="p">)</span>

<span class="c1"># Print result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_missing</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None
</pre></div>
</div>
</div>
</div>
<p>We can lower the min_confidence parameter value in the to_epsg() function, which will cause the function to return an EPSG code that is the closest match to the provided PROJ.4 string.</p>
<p><a class="reference external" href="https://geopandas.org/docs/user_guide/projections.html">https://geopandas.org/docs/user_guide/projections.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Call function to obtain relevant EPSG code and lower the minimum confidence value</span>
<span class="n">result_lower_confidence</span> <span class="o">=</span> <span class="n">get_epsg</span><span class="p">(</span><span class="s2">&quot;+proj=lcc +lat_1=38.43333333333333 +lat_2=37.06666666666667 +lat_0=36.5 +lon_0=-120.5 +ellps=GRS80 +datum=NAD83 +units=m +no_defs&quot;</span><span class="p">,</span> <span class="n">min_confidence</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Print result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_lower_confidence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26943
</pre></div>
</div>
</div>
</div>
<p>To get the PROJ.4 string from an EPSG code, we can use the rasterio module: <a class="reference external" href="https://rasterio.readthedocs.io/en/latest/api/rasterio.crs.html">https://rasterio.readthedocs.io/en/latest/api/rasterio.crs.html</a>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="d_exercises.html" title="previous page">CRS Exercises</a>
    <a class='right-next' id="next-link" href="e_vector_op_intro.html" title="next page">Vector Skills</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Michael Mann & Steven Chao<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>